{"title":"笔记-塔防游戏笔记","uid":"85c49446f7bdb1ca8252921bfb6d9cf6","slug":"笔记/笔记-塔防游戏笔记","date":"2024-06-25T13:47:56.000Z","updated":"2024-07-04T16:05:23.966Z","comments":true,"path":"api/articles/笔记/笔记-塔防游戏笔记.json","keywords":null,"cover":"\\img\\post\\笔记\\笔记-塔防游戏笔记\\cover.png","content":"<h1 id=\"介绍\"><a class=\"markdownIt-Anchor\" href=\"#介绍\"></a> 🔖介绍</h1>\n<p>该笔记主要参考于 v佬 <a href=\"https://space.bilibili.com/25864506\">Voidmatrix</a> 的 <a href=\"https://www.bilibili.com/cheese/play/ep749443\">C++双人塔防游戏开发</a> 课程。</p>\n<p>该笔记的复刻项目源码为：<a href=\"https://github.com/zExNocs/TowerDefenseGame_Copybat\">点击传送</a></p>\n<p>本笔记的内容排序可能不会按照课程排序，而是根据内容进行分类归纳。<br />\n本笔记主要由下面几个部分组成：<br />\n一. 游戏引擎 (框架解剖)<br />\n二. 游戏开发用到的设计模式 (技术解剖)<br />\n三. 开发步骤 (实践步骤)</p>\n<p>本笔记从各个游戏组成成分进行解剖，并介绍其功能和作用，然后开始介绍游戏开发的步骤。</p>\n<hr />\n<h1 id=\"一-游戏引擎\"><a class=\"markdownIt-Anchor\" href=\"#一-游戏引擎\"></a> 一. 游戏引擎</h1>\n<h2 id=\"基本框架介绍\"><a class=\"markdownIt-Anchor\" href=\"#基本框架介绍\"></a> 基本框架介绍</h2>\n<h2 id=\"相关类及其作用\"><a class=\"markdownIt-Anchor\" href=\"#相关类及其作用\"></a> 相关类及其作用</h2>\n<h3 id=\"gamemanager-游戏管理器\"><a class=\"markdownIt-Anchor\" href=\"#gamemanager-游戏管理器\"></a> <code>GameManager</code> 游戏管理器</h3>\n<p>介绍：<br />\n是游戏的主要引擎。用于初始化窗口、渲染器，并启动游戏主循环。</p>\n<p><em>在我的项目中称之为 <code>GameEngine</code> 而不是 <code>GameManager</code>。</em></p>\n<p>方法和功能：</p>\n<ul>\n<li>初始化断言 <code>init_assert(bool, char*)</code>：判断初始化是否成功，否则弹窗警告并关闭程序。</li>\n</ul>\n<hr />\n<h1 id=\"二-游戏开发用到的设计模式\"><a class=\"markdownIt-Anchor\" href=\"#二-游戏开发用到的设计模式\"></a> 二. 游戏开发用到的设计模式</h1>\n<h2 id=\"单例设计模式\"><a class=\"markdownIt-Anchor\" href=\"#单例设计模式\"></a> 单例设计模式</h2>\n<ul>\n<li><strong>介绍</strong></li>\n</ul>\n<p>单例设计模式(Singleton Design Pattern)指的是使用该设计模式的类在进程中最多只有一个实例。<br />\n其最大的特点就是不允许外部来创建该类的实例，而是提供一个内部静态函数/方法来间接创建该类：</p>\n<ul>\n<li><strong>构造函数</strong> 的访问类型是私有的(private)或者保护的(protected)。</li>\n<li>赋值构造函数和 <code>=</code> 符号重载为 <code>delete</code> 的方式来防止子类使用基类的构造。</li>\n</ul>\n<p>具体内容可以参考 <code>VoidGameSpace</code> 这个文章: <a href=\"https://www.voidgame.space/articles/yang12342/%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F/\">点击跳转</a></p>\n<ul>\n<li><strong>游戏开发中使用样例</strong></li>\n</ul>\n<p>一般游戏开发中的各种 <code>Manager</code> 会使用单例设计模式来实现。<br />\n可以使用 模板 + 继承 的方式实现各个衍生的 <code>Manager</code> 返回其指定的类而不是其基类。</p>\n<hr />\n<h1 id=\"三-开发步骤\"><a class=\"markdownIt-Anchor\" href=\"#三-开发步骤\"></a> 三. 开发步骤</h1>\n<ul>\n<li>构造基础的游戏框架 (<code>GameManager</code>类)：\n<ul>\n<li>初始化 <code>SDL</code> 组件，创建相关窗口、渲染器，并分析可能发生的错误。</li>\n<li>创建主循环函数。</li>\n</ul>\n</li>\n</ul>\n<hr />\n<h1 id=\"补充\"><a class=\"markdownIt-Anchor\" href=\"#补充\"></a> 补充：</h1>\n<h2 id=\"1-sdl-有关内容\"><a class=\"markdownIt-Anchor\" href=\"#1-sdl-有关内容\"></a> 1. SDL 有关内容</h2>\n<p>参考 <a href=\"/post/%E7%AC%94%E8%AE%B0%2F%E7%AC%94%E8%AE%B0-SDL%E7%9B%B8%E5%85%B3\">这篇笔记</a>。</p>\n<h2 id=\"2-cjson-有关内容\"><a class=\"markdownIt-Anchor\" href=\"#2-cjson-有关内容\"></a> 2. cJSON 有关内容</h2>\n<p><code>cJSON</code> 主要是包含 <code>cJSON</code> 结构体。<br />\n<code>cJSON</code> 结构体是一个类似于双向链表的树形结构，使用<code>next</code> 和 <code>prev</code> 指针指向相同层的前后数据，使用 <code>child</code> 指针指向下一层的数据(对象类型的子数据或者数组类型的成员，统称为子节点)。</p>\n<p>因为 <code>cJSON</code> 是使用c语言进行编写，所以其是一个面向过程的类型，不具有成员函数/方法。</p>\n<h3 id=\"cjson-结构体变量\"><a class=\"markdownIt-Anchor\" href=\"#cjson-结构体变量\"></a> &gt; cJSON 结构体变量</h3>\n<ul>\n<li><code>int type</code>：该节点的数据类型。\n<ul>\n<li><code>cJSON_Invalid</code>：不合理的类型</li>\n<li><code>cJSON_False</code>：布尔<code>false</code> 类型</li>\n<li><code>cJSON_True</code>：布尔<code>true</code> 类型</li>\n<li><code>cJSON_NULL</code>：<code>null</code> 类型</li>\n<li><code>cJSON_Number</code>：数字类型</li>\n<li><code>cJSON_String</code>：字符串类型</li>\n<li><code>cJSON_Array</code>：数组类型</li>\n<li><code>cJSON_Object</code>：对象类型</li>\n<li><code>cJSON_Raw</code>：<code>raw json</code>，生 <code>json</code> 类型</li>\n</ul>\n</li>\n<li><code>char* string</code>：如果该节点是一个内部节点，那么该变量储存该节点的名字。</li>\n<li><code>char* valuestring</code>：如果该节点是字符串类型或者<code>raw json</code>，那么该变量储存该字符串。</li>\n<li><code>int valueint</code>：如果该节点是数字的整型类型，那么该变量储存该整型。</li>\n<li><code>double valuedouble</code>：如果该节点是数字的浮点类型，那么该变量储存该浮点型。</li>\n<li><code>cJSON* next</code>：如果该节点是某个<strong>对象类型的子数据</strong> 或者 <strong>数组类型的成员</strong>，那么该变量指向下一个节点。</li>\n<li><code>cJSON* prev</code>：如果该节点是某个<strong>对象类型的子数据</strong> 或者 <strong>数组类型的成员</strong>，那么该变量指向上一个节点。</li>\n<li><code>cJSON* child</code>：如果节点是 <strong>对象类型</strong> 或者 <strong>数组类型</strong>，那么该变量指向其子节点。</li>\n</ul>\n<h3 id=\"cjson-函数\"><a class=\"markdownIt-Anchor\" href=\"#cjson-函数\"></a> &gt; cJSON 函数</h3>\n<ul>\n<li><code>cJSON* cJSON_Parse(char* str)</code>：将字符串<code>str</code>解析成 <code>cJSON</code> 类并返回该<strong>对象类型</strong>的指针。</li>\n<li><code>cJSON* cJSON_GetObjectItem(cJSON* object, char* string)</code>：返回<strong>对象类型</strong><code>object</code>中名字为 <code>string</code> 子数据。</li>\n</ul>\n<h3 id=\"cjson-宏定义\"><a class=\"markdownIt-Anchor\" href=\"#cjson-宏定义\"></a> &gt; cJSON 宏定义</h3>\n<ul>\n<li><code>#define cJSON_ArrayForEach(cJSON* element, cJSON* array)</code>：遍历<strong>数组类型</strong><code>array</code>的所有成员作为<code>element</code>。</li>\n</ul>\n<p>一般使用下面的代码来读取一个 <code>.json</code> 文件：</p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 打开文件</span></span><br><span class=\"line\"><span class=\"function\">std::ifstream <span class=\"title\">file</span><span class=\"params\">(<span class=\"string\">&quot;文件名.json&quot;</span>)</span></span>;</span><br><span class=\"line\"><span class=\"keyword\">if</span>(!file.<span class=\"built_in\">good</span>()) &#123; 报错 + 退出 &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 使用stringstream来读取整个字符串</span></span><br><span class=\"line\">std::stringstream str_stream;</span><br><span class=\"line\">str_stream &lt;&lt; file.<span class=\"built_in\">rdbuf</span>();</span><br><span class=\"line\">file.<span class=\"built_in\">close</span>();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 解析</span></span><br><span class=\"line\">cJSON* root = <span class=\"built_in\">cJSON_Parse</span>(str_stream.<span class=\"built_in\">str</span>().<span class=\"built_in\">c_str</span>());</span><br></pre></td></tr></table></figure>\n<h2 id=\"3-项目创建和环境搭建\"><a class=\"markdownIt-Anchor\" href=\"#3-项目创建和环境搭建\"></a> 3. 项目创建和环境搭建</h2>\n<h3 id=\"下载相关库\"><a class=\"markdownIt-Anchor\" href=\"#下载相关库\"></a> 下载相关库</h3>\n<p><em>选择带 <code>VC</code> 的包下载</em></p>\n<ul>\n<li><a href=\"https://github.com/libsdl-org/SDL\">SDL 本体</a></li>\n<li><a href=\"https://github.com/libsdl-org/SDL_ttf\">SDL_ttf 文字渲染</a></li>\n<li><a href=\"https://github.com/libsdl-org/SDL_image\">SDL_image 图片渲染</a></li>\n<li><a href=\"https://github.com/libsdl-org/SDL_mixer\">SDL_mixer 音媒体</a></li>\n<li><a href=\"https://www.ferzkopp.net/wordpress/2016/01/02/sdl_gfx-sdl2_gfx/\">SDL_gfx 图形绘制</a></li>\n<li><a href=\"https://github.com/DaveGamble/cJSON\">cJSON</a></li>\n</ul>\n<h3 id=\"导入库\"><a class=\"markdownIt-Anchor\" href=\"#导入库\"></a> 导入库</h3>\n<p>在项目根目录中新增 <code>thirdparty</code> 文件夹，将下载的库解压放入其中。</p>\n<p>使用相对路径将库添加到项目中：<br />\n右键选择相应的解决方案资源管理器，如本项目中的 <code>TowerrDefenseGame_Copybat</code>，选择 <code>属性</code>：</p>\n<ul>\n<li>导入头文件：依次点击 <code>C/C++ → 常规 → 附加包含目录 → &lt;编辑...&gt; → 新行</code>，输入 <code>..\\thirdparty\\&lt;相关库&gt;\\include</code>。</li>\n<li>导入静态链接器：\n<ul>\n<li>目录：依次点击 <code>链接器 → 常规 → 附加库目录 → &lt;编辑...&gt; → 新行</code>，输入 <code>..\\thirdparty\\&lt;相关库&gt;\\lib\\x64</code></li>\n<li>输入：依次点击 <code>链接器 → 输入 → 附加依赖项 → &lt;编辑...&gt;</code>，输入所有 <code>thirdparty\\&lt;相关库&gt;\\lib\\x64</code> 路径下所有后缀 <code>.lib</code> 的文件名和后缀。<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">SDL2.lib</span><br><span class=\"line\">SDL2main.lib</span><br><span class=\"line\">SDL2_ttf.lib</span><br><span class=\"line\">SDL2_mixer.lib</span><br><span class=\"line\">SDL2_image.lib</span><br><span class=\"line\">SDL2_gfx.lib</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n</li>\n<li>导入动态链接器：将动态链接器 <code>dll后缀文件</code> 复制到相应的解决方案目录下。</li>\n<li>导入源码库：将源码库的 <code>.c</code> 文件直接拖拽到 <code>解决方案资源管理器 &gt; 解决方案 &gt; 源文件</code> 中。</li>\n</ul>\n","feature":false,"text":"这是关于 Voidmatrix 塔防游戏课程笔记。...","permalink":"/post/笔记/笔记-塔防游戏笔记","photos":[],"count_time":{"symbolsCount":"2.8k","symbolsTime":"3 mins."},"categories":[{"name":"笔记","slug":"笔记","count":6,"path":"api/categories/笔记.json"}],"tags":[{"name":"Game Engine","slug":"Game-Engine","count":2,"path":"api/tags/Game-Engine.json"},{"name":"SDL","slug":"SDL","count":2,"path":"api/tags/SDL.json"},{"name":"CPP","slug":"CPP","count":2,"path":"api/tags/CPP.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E4%BB%8B%E7%BB%8D\"><span class=\"toc-text\"> 🔖介绍</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E4%B8%80-%E6%B8%B8%E6%88%8F%E5%BC%95%E6%93%8E\"><span class=\"toc-text\"> 一. 游戏引擎</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%9F%BA%E6%9C%AC%E6%A1%86%E6%9E%B6%E4%BB%8B%E7%BB%8D\"><span class=\"toc-text\"> 基本框架介绍</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E7%9B%B8%E5%85%B3%E7%B1%BB%E5%8F%8A%E5%85%B6%E4%BD%9C%E7%94%A8\"><span class=\"toc-text\"> 相关类及其作用</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#gamemanager-%E6%B8%B8%E6%88%8F%E7%AE%A1%E7%90%86%E5%99%A8\"><span class=\"toc-text\"> GameManager 游戏管理器</span></a></li></ol></li></ol></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E4%BA%8C-%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91%E7%94%A8%E5%88%B0%E7%9A%84%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F\"><span class=\"toc-text\"> 二. 游戏开发用到的设计模式</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%8D%95%E4%BE%8B%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F\"><span class=\"toc-text\"> 单例设计模式</span></a></li></ol></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E4%B8%89-%E5%BC%80%E5%8F%91%E6%AD%A5%E9%AA%A4\"><span class=\"toc-text\"> 三. 开发步骤</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E8%A1%A5%E5%85%85\"><span class=\"toc-text\"> 补充：</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#1-sdl-%E6%9C%89%E5%85%B3%E5%86%85%E5%AE%B9\"><span class=\"toc-text\"> 1. SDL 有关内容</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#2-cjson-%E6%9C%89%E5%85%B3%E5%86%85%E5%AE%B9\"><span class=\"toc-text\"> 2. cJSON 有关内容</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#cjson-%E7%BB%93%E6%9E%84%E4%BD%93%E5%8F%98%E9%87%8F\"><span class=\"toc-text\"> &gt; cJSON 结构体变量</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#cjson-%E5%87%BD%E6%95%B0\"><span class=\"toc-text\"> &gt; cJSON 函数</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#cjson-%E5%AE%8F%E5%AE%9A%E4%B9%89\"><span class=\"toc-text\"> &gt; cJSON 宏定义</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#3-%E9%A1%B9%E7%9B%AE%E5%88%9B%E5%BB%BA%E5%92%8C%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA\"><span class=\"toc-text\"> 3. 项目创建和环境搭建</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E4%B8%8B%E8%BD%BD%E7%9B%B8%E5%85%B3%E5%BA%93\"><span class=\"toc-text\"> 下载相关库</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%AF%BC%E5%85%A5%E5%BA%93\"><span class=\"toc-text\"> 导入库</span></a></li></ol></li></ol></li></ol>","author":{"name":"zExNocs","slug":"blog-author","avatar":"/img/avatar.jpg","link":"/","description":"一个喜欢摸鱼的人。<p>去码头整点薯条。</p>","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"github":{"icon":"/img/svg/github.svg","link":"https://github.com/zExNocs"},"bilibili":{"icon":"/img/svg/bilibili.svg","link":"https://space.bilibili.com/13423200"},"steam":{"icon":"/img/svg/steam.svg","link":"https://steamcommunity.com/id/zExNocs/"},"QQ":{"icon":"/img/svg/QQ.svg","link":"https://qm.qq.com/q/XtwuUQpNCg"}}}},"mapped":true,"hidden":false,"prev_post":{"title":"笔记-SDL相关","uid":"a4b0df2890ed17f671a91e3b94352236","slug":"笔记/笔记-SDL相关","date":"2024-07-01T09:05:30.000Z","updated":"2024-07-04T18:40:21.108Z","comments":true,"path":"api/articles/笔记/笔记-SDL相关.json","keywords":null,"cover":"\\img\\post\\笔记\\笔记-SDL相关\\cover.png","text":"关于SDL库相关的常用的类和接口的笔记。...","permalink":"/post/笔记/笔记-SDL相关","photos":[],"count_time":{"symbolsCount":"2.7k","symbolsTime":"2 mins."},"categories":[{"name":"笔记","slug":"笔记","count":6,"path":"api/categories/笔记.json"}],"tags":[{"name":"SDL","slug":"SDL","count":2,"path":"api/tags/SDL.json"},{"name":"CPP","slug":"CPP","count":2,"path":"api/tags/CPP.json"}],"author":{"name":"zExNocs","slug":"blog-author","avatar":"/img/avatar.jpg","link":"/","description":"一个喜欢摸鱼的人。<p>去码头整点薯条。</p>","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"github":{"icon":"/img/svg/github.svg","link":"https://github.com/zExNocs"},"bilibili":{"icon":"/img/svg/bilibili.svg","link":"https://space.bilibili.com/13423200"},"steam":{"icon":"/img/svg/steam.svg","link":"https://steamcommunity.com/id/zExNocs/"},"QQ":{"icon":"/img/svg/QQ.svg","link":"https://qm.qq.com/q/XtwuUQpNCg"}}}},"feature":false},"next_post":{"title":"笔记-游戏开发笔记","uid":"c0a95ceab12c74bbb654e3403dd31ec5","slug":"笔记/笔记-游戏开发笔记","date":"2024-06-09T23:25:51.000Z","updated":"2024-06-25T13:52:05.490Z","comments":true,"path":"api/articles/笔记/笔记-游戏开发笔记.json","keywords":null,"cover":"\\img\\post\\笔记\\笔记-游戏开发笔记\\cover.png","text":"这是一个关于游戏开发的知识笔记。...","permalink":"/post/笔记/笔记-游戏开发笔记","photos":[],"count_time":{"symbolsCount":12,"symbolsTime":"1 mins."},"categories":[{"name":"笔记","slug":"笔记","count":6,"path":"api/categories/笔记.json"}],"tags":[{"name":"Game Engine","slug":"Game-Engine","count":2,"path":"api/tags/Game-Engine.json"}],"author":{"name":"zExNocs","slug":"blog-author","avatar":"/img/avatar.jpg","link":"/","description":"一个喜欢摸鱼的人。<p>去码头整点薯条。</p>","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"github":{"icon":"/img/svg/github.svg","link":"https://github.com/zExNocs"},"bilibili":{"icon":"/img/svg/bilibili.svg","link":"https://space.bilibili.com/13423200"},"steam":{"icon":"/img/svg/steam.svg","link":"https://steamcommunity.com/id/zExNocs/"},"QQ":{"icon":"/img/svg/QQ.svg","link":"https://qm.qq.com/q/XtwuUQpNCg"}}}},"feature":false}}